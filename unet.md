# UNET



# ![Screenshot from 2025-08-06 09-36-57](/home/office2004/Pictures/Screenshot from 2025-08-06 09-36-57.png)

#### **1. 输入原图**

- 比如一张 512×512 的显微图像。

#### **2. 编码器（下采样路径）**

- 结构：`Conv → ReLU → Conv → ReLU → MaxPool`
- 功能：
  - 提取图像中的高级语义特征。
  - 每次下采样都会减小图像尺寸、增加通道数。

#### **3. 解码器（上采样路径）**

- 结构：`UpConv（反卷积/上采样） → 拼接（concat） → Conv → ReLU → Conv → ReLU`
- 功能：
  - 上采样恢复图像空间尺寸。
  - 与编码器中相同层级的特征图进行拼接（跳跃连接），保留细节信息。

#### **4. 输出预测分割图**

- 最后一层使用 **1x1 卷积**将通道数映射为类别数（例如2类：前景+背景）。
- 得到一张与原图大小一致的“预测标签图”。

#### **5. 与真值（Ground Truth）对比计算 Loss**

- 常用的损失函数包括：
  - **交叉熵（Cross Entropy）**
  - **Dice Loss（尤其在医学图像中）**
  - 或者**加权损失函数**（UNet 原论文中为了分离粘连的细胞，使用了 pixel-wise weighted cross-entropy）

#### **6. 反向传播 + 参数更新**

- 使用梯度下降（如 SGD、Adam）对网络中的卷积核权重进行更新。
